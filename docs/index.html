<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ìˆ˜ì‚°ë¬¼ ê±´ê°• ì±—ë´‡ Â· ì‹œë²”</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <style>
    :root{--bg:#0f141a;--panel:#121a22;--text:#e6edf3;--muted:#9fb0bf;--accent:#2f81f7;--chip:#1b2733;--chipText:#d7e2ea;--ring:#4f91ff;--border:#223041}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
    .wrap{max-width:1280px;margin:24px auto;padding:0 16px}
    .grid{display:grid;gap:16px;grid-template-columns:1fr 1fr 1fr}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px;min-height:420px}
    h2{margin:0 0 12px;font-size:24px}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{background:var(--chip);color:var(--chipText);border:1px solid var(--border);border-radius:999px;padding:8px 12px;font-size:14px;cursor:pointer;user-select:none;outline:0}
    .chip:focus{box-shadow:0 0 0 3px var(--ring)}
    .chip.active{background:var(--accent);color:#fff;border-color:transparent}
    .muted{color:var(--muted)}
    .content{white-space:pre-wrap;line-height:1.6}
    .btn{background:#1b2a3a;color:#d7e2ea;border:1px solid var(--border);border-radius:10px;padding:10px 14px;font-size:14px;cursor:pointer}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    @media (max-width:1024px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <div class="panel">
        <h2>ì¹´í…Œê³ ë¦¬</h2>
        <div id="categoryList" class="chips" aria-label="ì¹´í…Œê³ ë¦¬ ëª©ë¡"></div>
      </div>

      <div class="panel">
        <h2>ì–´ì¢…</h2>
        <div id="fishList" class="chips" aria-label="ì–´ì¢… ëª©ë¡"></div>
      </div>

      <div class="panel">
        <h2>ì„¸ë¶€ ë‚´ìš©</h2>
        <div class="toolbar">
          <button id="btnAll" class="btn">ì „ì²´ ë³´ê¸°</button>
          <button id="btnSource" class="btn">ì¶œì²˜</button>
        </div>
        <div id="content" class="content" style="margin-top:10px;">ì„¹ì…˜ì„ ì„ íƒí•˜ì„¸ìš”.</div>
        <p class="muted" style="margin-top:16px">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ë©´ ì˜¤ë¥¸ìª½ì— ì–´ì¢…ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì–´ì¢…ì„ ì„ íƒí•˜ë©´ â€˜ì¶œì²˜ / ì£¼ìš”ì˜ì–‘ì†Œ / ì•½íš¨ ë° íš¨ìš© / ì œì²  ë° ì„ íƒë²• / ì¡°ë¦¬ í¬ì¸íŠ¸ / ì–´ìš¸ë¦¬ëŠ” ìš”ë¦¬ / ë ˆì‹œí”¼â€™ë¥¼ ê³ ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <p class="muted">ë°ì´í„°ëŠ” <code>health_fish.json</code>ì—ì„œ ë¡œë“œë©ë‹ˆë‹¤.</p>
      </div>
    </div>
  </div>

  <!-- í´ë°± ë°ì´í„° (fetch ì‹¤íŒ¨ì‹œ ìë™ ì‚¬ìš©) -->
  <script id="healthDataInline" type="application/json">
  {
    "categories": {
      "ê³ í˜ˆì•• ì˜ˆë°©": ["ê¹€","ë‹¤ì‹œë§ˆ","ë©¸ì¹˜","ê°€ë¦¬ë¹„","ë¯¸ì—­","í†³","ìš°ë­‡ê°€ì‚¬ë¦¬","ë§¤ìƒì´"],
      "ê°„ ê¸°ëŠ¥ í–¥ìƒ": ["ë¬¸ì–´","ë‚™ì§€","ëŒ€í•˜","ê½ƒê²Œ","ì£¼ê¾¸ë¯¸","ì†Œë¼","ê¼¬ë§‰","ì¬ì²©","ë°”ì§€ë½","ëŒ€í•©"]
    }
  }
  </script>

  <script>
  (function(){
    const $ = (s)=>document.querySelector(s);
    const categoryList = $('#categoryList');
    const fishList = $('#fishList');
    const content = $('#content');
    const btnAll = $('#btnAll');
    const btnSource = $('#btnSource');

    let DATA=null, currentCategory=null, currentFish=null;

    function renderCategories(){
      categoryList.innerHTML='';
      Object.keys(DATA.categories).forEach(cat=>{
        const chip=document.createElement('button');
        chip.className='chip';
        chip.textContent=cat;
        chip.onclick=()=>{
          currentCategory=cat; currentFish=null;
          [...categoryList.children].forEach(c=>c.classList.remove('active'));
          chip.classList.add('active');
          renderFish();
          content.textContent=`[${cat}] ì–´ì¢…ì„ ì„ íƒí•˜ì„¸ìš”.`;
        };
        categoryList.appendChild(chip);
      });
    }

    function renderFish(){
      fishList.innerHTML='';
      (DATA.categories[currentCategory]||[]).forEach(f=>{
        const chip=document.createElement('button');
        chip.className='chip';
        chip.textContent=f;
        chip.onclick=()=>{
          currentFish=f;
          [...fishList.children].forEach(c=>c.classList.remove('active'));
          chip.classList.add('active');
          renderDetails('source');
        };
        fishList.appendChild(chip);
      });
    }

    function renderDetails(mode){
      if(!currentCategory||!currentFish){content.textContent='ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”.';return;}
      const d=(DATA.details&&DATA.details[currentFish])||{};
      const blocks=[
        ['ì¶œì²˜', d['ì¶œì²˜']],
        ['ì£¼ìš”ì˜ì–‘ì†Œ', d['ì£¼ìš”ì˜ì–‘ì†Œ']],
        ['ì•½íš¨ ë° íš¨ìš©', d['ì•½íš¨ ë° íš¨ìš©']],
        ['ì œì²  ë° ì„ íƒë²•', d['ì œì²  ë° ì„ íƒë²•']],
        ['ì¡°ë¦¬ í¬ì¸íŠ¸', d['ì¡°ë¦¬ í¬ì¸íŠ¸']],
        ['ì–´ìš¸ë¦¬ëŠ” ìš”ë¦¬', d['ì–´ìš¸ë¦¬ëŠ” ìš”ë¦¬']],
        ['ë ˆì‹œí”¼', d['ë ˆì‹œí”¼']]
      ];
      if(mode==='all'){
        const lines=[];
        lines.push(`ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.\n[${currentCategory}] ì–´ì¢…ì„ ì„ íƒí•˜ì„¸ìš”.\n`);
        lines.push(`[${currentCategory} Â· ${currentFish}]`);
        lines.push('ãƒ» ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”.\n');
        lines.push('ğŸ“° ì „ì²´ ë³´ê¸°');
        blocks.forEach(([k,v])=>{lines.push(`- ${k}`);lines.push(v?String(v):'ì •ë³´ ì—†ìŒ');});
        content.textContent=lines.join('\n');
      }else{
        const val=d['ì¶œì²˜']?String(d['ì¶œì²˜']):'ì •ë³´ ì—†ìŒ';
        content.textContent=`ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.\n[${currentCategory}] ì–´ì¢…ì„ ì„ íƒí•˜ì„¸ìš”.\n\n[${currentCategory} Â· ${currentFish}]\nãƒ» ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”.\n\nğŸªª ì¶œì²˜\n${val}`;
      }
    }

    btnAll.onclick=()=> currentFish ? renderDetails('all') : content.textContent='Â· ì „ì²´ ë³´ê¸°ëŠ” ì–´ì¢… ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–´ì¢…ì„ ë¨¼ì € ì„ íƒí•´ ì£¼ì„¸ìš”.';
    btnSource.onclick=()=> currentFish ? renderDetails('source') : content.textContent='Â· ì¶œì²˜ëŠ” ì–´ì¢… ì„ íƒ í›„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–´ì¢…ì„ ë¨¼ì € ì„ íƒí•´ ì£¼ì„¸ìš”.';

    async function loadData(){
      // 1) ì™¸ë¶€ JSON ì‹œë„ (ìºì‹œ ë¬´íš¨í™”)
      try{
        const res=await fetch(`health_fish.json?ts=${Date.now()}`,{cache:'no-store'});
        if(!res.ok) throw new Error(res.status);
        const json=await res.json();
        if(!json||!json.categories) throw new Error('invalid schema');
        console.log('[health-fish] loaded from health_fish.json');
        return json;
      }catch(e){
        console.warn('[health-fish] fetch failed, use inline fallback', e);
      }
      // 2) ì¸ë¼ì¸ í´ë°±
      try{
        const inline=$('#healthDataInline');
        if(inline && inline.textContent.trim()){
          const json=JSON.parse(inline.textContent);
          if(json && json.categories){
            console.log('[health-fish] loaded from inline fallback');
            return json;
          }
        }
      }catch(e){console.error(e);}
      return null;
    }

    window.addEventListener('DOMContentLoaded', async()=>{
      DATA=await loadData();
      if(!DATA){
        content.innerHTML='ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. <br>docs/health_fish.json ì¡´ì¬/ì² ì/ê²½ë¡œ í™•ì¸';
        return;
      }
      DATA.details = DATA.details || {}; // details ì—†ì„ ìˆ˜ë„ ìˆì–´ ì•ˆì „ ê°€ë“œ
      renderCategories();
      content.textContent='ì¹´í…Œê³ ë¦¬ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.';
    });
  })();
  </script>
</body>
</html>
